<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Virtual HealthCare — Local Prototype</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --bg1:#071028; --bg2:#0f1724;
      --card:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      --glass:rgba(255,255,255,0.03);
      --muted:#98a6b3; --text:#e6eef8; --accent:#6b7bff; --accent-2:#2fd2a4;
      --shadow: 0 10px 30px rgba(5,8,20,0.6);
    }

    *{box-sizing:border-box;margin:0;padding:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
    html,body{height:100%}
    body{min-height:100vh;background:radial-gradient(1200px 600px at 10% 10%, rgba(107,123,255,0.14), transparent), linear-gradient(180deg,var(--bg1),var(--bg2));color:var(--text);padding:28px}

    .app{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:260px 1fr;gap:20px;align-items:start}

    header.app-header{grid-column:1/-1;display:flex;align-items:center;gap:18px;padding:18px;border-radius:14px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow:var(--shadow)}
    .brand{display:flex;flex-direction:column}
    .brand-title{font-weight:800;font-size:1.25rem;background:linear-gradient(90deg,var(--accent-2),var(--accent));-webkit-background-clip:text;background-clip:text;color:transparent}
    .brand-sub{color:var(--muted);font-size:0.9rem}

    .header-actions{margin-left:auto;display:flex;gap:12px;align-items:center}
    .btn{background:linear-gradient(135deg,var(--accent),#7a6bff);border:none;color:white;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;display:inline-flex;gap:10px;align-items:center;box-shadow:0 6px 18px rgba(83,92,255,0.12);transition:transform .12s ease,box-shadow .12s ease}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--text);padding:10px 12px}
    .btn:hover{transform:translateY(-3px);box-shadow:0 14px 30px rgba(20,28,80,0.35)}

    /* Sidebar */
    .sidebar{background:var(--card);padding:18px;border-radius:14px;border:1px solid rgba(255,255,255,0.03);height:calc(100vh - 120px);overflow:auto;box-shadow:var(--shadow)}
    .profile{display:flex;gap:12px;align-items:center}
    .avatar{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1.05rem;color:#05102a;box-shadow:0 6px 18px rgba(47,210,164,0.08)}
    .user-info{line-height:1}
    .user-name{font-weight:800}
    .user-role{color:var(--muted);font-size:0.85rem}

    .nav{margin-top:16px;display:flex;flex-direction:column;gap:8px}
    .nav button{display:flex;gap:12px;align-items:center;padding:10px;border-radius:12px;background:transparent;border:none;color:var(--text);text-align:left;cursor:pointer;font-weight:600}
    .nav button.active{background:linear-gradient(90deg,rgba(107,123,255,0.12),rgba(47,210,164,0.04));border:1px solid rgba(255,255,255,0.02)}

    .muted{color:var(--muted)}

    /* Main content */
    .main-area{display:grid;grid-template-rows:auto 1fr;gap:16px}
    .cards{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .card{background:var(--card);padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}

    .doctor-list{display:flex;flex-direction:column;gap:12px;margin-top:12px}
    .doctor{display:flex;gap:12px;align-items:center;padding:12px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02);transition:transform .12s ease,box-shadow .12s ease}
    .doctor:hover{transform:translateY(-6px);box-shadow:0 18px 40px rgba(10,12,30,0.6)}
    .doctor .meta{flex:1}
    .chip{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.02);font-size:0.85rem;color:var(--muted)}

    label{font-weight:700;color:var(--muted);font-size:0.9rem}
    input,select,textarea{width:100%;padding:11px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);outline:none}
    input:focus,select:focus,textarea:focus{box-shadow:0 8px 24px rgba(83,92,255,0.06);border-color:rgba(107,123,255,0.22)}

    .appointments{display:flex;flex-direction:column;gap:10px;margin-top:12px}
    .appt{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.02)}

    .history-list{display:flex;flex-direction:column;gap:10px}
    .history-item{padding:12px;border-radius:10px;background:linear-gradient(90deg, rgba(107,123,255,0.02), rgba(47,210,164,0.01));border:1px solid rgba(255,255,255,0.02)}

    .video-stage{display:flex;gap:12px;align-items:flex-start}
    video{border-radius:12px;background:#000;max-width:100%;object-fit:cover}

    .advice{padding:12px;border-radius:10px;background:linear-gradient(90deg,rgba(91,107,255,0.08),rgba(41,194,155,0.04));border:1px solid rgba(255,255,255,0.02);color:var(--text)}

    /* micro helpers */
    .mt-12{margin-top:12px}
    .mt-8{margin-top:8px}

    @media(max-width:980px){
      .app{grid-template-columns:1fr}
      .sidebar{height:auto}
      .cards{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="brand">
        <div class="brand-title">Virtual HealthCare</div>
        <div class="brand-sub">Book appointments • Telehealth • Personal medical history</div>
      </div>

      <div class="header-actions">
        <button id="exportHistory" class="btn"><i class="fa-solid fa-file-export"></i> Export</button>
        <button id="helpBtn" class="btn ghost"><i class="fa-solid fa-circle-question"></i> Help</button>
      </div>
    </header>

    <aside class="sidebar">
      <div class="profile">
        <div class="avatar">VK</div>
        <div class="user-info">
          <div class="user-name">Patient</div>
          <div class="user-role">Local-first prototype</div>
        </div>
      </div>

      <nav class="nav" id="nav">
        <button class="active" data-view="dashboard"><i class="fa-solid fa-grid"></i> Dashboard</button>
        <button data-view="book"><i class="fa-solid fa-calendar-plus"></i> Book</button>
        <button data-view="history"><i class="fa-solid fa-folder-medical"></i> History</button>
        <button data-view="telehealth"><i class="fa-solid fa-video"></i> Telehealth</button>
        <button data-view="support"><i class="fa-solid fa-stethoscope"></i> Support</button>
      </nav>

      <hr style="margin-top:14px;border:none;border-top:1px solid rgba(255,255,255,0.04)">

      <div style="margin-top:14px">
        <div class="muted">Available doctors</div>
        <div class="doctor-list" id="doctorList"></div>
      </div>
    </aside>

    <main class="main-area">
      <div id="contentTop"></div>
      <div id="content" style="min-height:460px"></div>
    </main>
  </div>

<script>
/* Full app logic merged into polished UI */
const STORAGE_KEY = 'vhc_app_v1';
const DOCTORS = [
  {id:'d1',name:'Dr. Maya Chen',specialty:'General Physician',avatar:'MC'},
  {id:'d2',name:'Dr. Arjun Patel',specialty:'Pediatrics',avatar:'AP'},
  {id:'d3',name:'Dr. Leila Gomez',specialty:'Psychiatry',avatar:'LG'}
];
let appState = { appointments: [], history: [] };
function load(){ const s = localStorage.getItem(STORAGE_KEY); if(s) { try{ appState = JSON.parse(s); }catch(e){ appState={appointments:[],history:[]}; } } }
function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(appState)); }
function uid(){ return Date.now().toString(36)+'-'+Math.random().toString(36).slice(2,8); }

const doctorListDiv = document.getElementById('doctorList');
function renderDoctors(){ doctorListDiv.innerHTML='';
  DOCTORS.forEach(d=>{
    const el = document.createElement('div'); el.className='doctor';
    el.innerHTML = `<div class="avatar">${d.avatar}</div><div class="meta"><div style="font-weight:800">${d.name}</div><div class="muted">${d.specialty}</div></div><div><button class='btn ghost' data-doctor='${d.id}'>Book</button></div>`;
    doctorListDiv.appendChild(el);
  });
  doctorListDiv.querySelectorAll('button').forEach(b=> b.addEventListener('click', ()=>{ showView('book'); preselectDoctor(b.dataset.doctor); }));
}

// Navigation
document.getElementById('nav').addEventListener('click', (ev)=>{
  const btn = ev.target.closest('button'); if(!btn) return;
  document.querySelectorAll('#nav button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  showView(btn.dataset.view);
});

const content = document.getElementById('content');
const contentTop = document.getElementById('contentTop');
function showView(view){ switch(view){ case 'dashboard': renderDashboard(); break; case 'book': renderBooking(); break; case 'history': renderHistory(); break; case 'telehealth': renderTelehealth(); break; case 'support': renderSupport(); break; default: renderDashboard(); } }

// Dashboard
function renderDashboard(){
  contentTop.innerHTML = `<div class="cards"><div class="card"><h3>Upcoming</h3><div id='upcoming'></div></div><div class="card"><h3>Quick Actions</h3><div style='display:flex;flex-direction:column;gap:10px;margin-top:12px'><button id='newAppt' class='btn'>Book Appointment</button><button id='openHistory' class='btn ghost'>Add Medical Note</button><button id='startCall' class='btn'>Start Telehealth Call</button></div></div></div>`;
  content.innerHTML = `<div class='card'><h3>Summary</h3><div style='display:flex;gap:18px;align-items:center;margin-top:12px'><div style='flex:1'><div class='muted'>Total appointments</div><div style='font-size:1.4rem;font-weight:800;margin-top:6px'>${appState.appointments.length}</div></div><div style='flex:1'><div class='muted'>History entries</div><div style='font-size:1.4rem;font-weight:800;margin-top:6px'>${appState.history.length}</div></div></div></div><div class='card mt-12'><h3>Appointments (latest)</h3><div id='apptList' class='appointments' style='margin-top:12px'></div></div>`;
  document.getElementById('newAppt').addEventListener('click', ()=> showView('book'));
  document.getElementById('openHistory').addEventListener('click', ()=> showView('history'));
  document.getElementById('startCall').addEventListener('click', ()=> showView('telehealth'));
  renderUpcoming(); renderApptList();
}
function renderUpcoming(){ const up = document.getElementById('upcoming'); up.innerHTML='';
  const next = appState.appointments.slice().sort((a,b)=> new Date(a.when)-new Date(b.when)).slice(0,3);
  if(next.length===0) up.innerHTML='<div class="muted">No upcoming appointments</div>';
  next.forEach(a=>{ const el = document.createElement('div'); el.className='appt'; el.innerHTML = `<div><div style='font-weight:800'>${a.doctorName}</div><div class='muted'>${new Date(a.when).toLocaleString()}</div></div><div><button class='btn ghost' data-id='${a.id}'>Cancel</button></div>`; up.appendChild(el); });
  up.querySelectorAll('button').forEach(b=>b.addEventListener('click', ()=>{ cancelAppointment(b.dataset.id); }));
}
function renderApptList(){ const list = document.getElementById('apptList'); list.innerHTML='';
  if(appState.appointments.length===0) list.innerHTML='<div class="muted">No appointments yet</div>';
  appState.appointments.slice().reverse().forEach(a=>{
    const el = document.createElement('div'); el.className='appt';
    el.innerHTML = `<div><div style='font-weight:800'>${a.doctorName}</div><div class='muted'>${new Date(a.when).toLocaleString()}</div><div style='margin-top:6px'>${a.reason}</div></div><div style='display:flex;flex-direction:column;gap:8px'><button class='btn' data-id='${a.id}'>Details</button><button class='btn ghost' data-cancel='${a.id}'>Cancel</button></div>`;
    list.appendChild(el);
  });
  list.querySelectorAll('button[data-id]').forEach(b=>b.addEventListener('click', ()=>{ alert('Appointment details:\n'+ JSON.stringify(appState.appointments.find(x=>x.id===b.dataset.id), null, 2)); }));
  list.querySelectorAll('button[data-cancel]').forEach(b=>b.addEventListener('click', ()=>{ cancelAppointment(b.dataset.cancel); }));
}
function cancelAppointment(id){ if(!confirm('Cancel appointment?')) return; appState.appointments = appState.appointments.filter(a=>a.id!==id); save(); renderDashboard(); }

// Booking
let preselectedDoctor = null;
function preselectDoctor(id){ preselectedDoctor = id; }
function renderBooking(){ contentTop.innerHTML = `<div class='card'><h3>Book a Quick Visit</h3></div>`;
  content.innerHTML = `<div class='card'><label class='field'>Select doctor</label><select id='doctorSelect'></select><div class='field mt-8'><label>Date & Time</label><input id='when' type='datetime-local'></div><div class='field mt-8'><label>Reason</label><input id='reason' placeholder='e.g., sore throat, check-up'></div><div style='margin-top:12px;display:flex;gap:8px'><button id='bookBtn' class='btn'>Book Appointment</button><button id='backDash' class='btn ghost'>Back</button></div></div>`;
  const sel = document.getElementById('doctorSelect'); DOCTORS.forEach(d=>{ const opt = document.createElement('option'); opt.value=d.id; opt.textContent = `${d.name} — ${d.specialty}`; sel.appendChild(opt); });
  if(preselectedDoctor) sel.value = preselectedDoctor;
  document.getElementById('backDash').addEventListener('click', ()=> showView('dashboard'));
  document.getElementById('bookBtn').addEventListener('click', ()=>{
    const did = sel.value; const when = document.getElementById('when').value; const reason = document.getElementById('reason').value.trim();
    if(!when || !reason){ alert('Please provide date/time and a brief reason'); return; }
    const doc = DOCTORS.find(d=>d.id===did);
    const appt = { id: uid(), doctorId: did, doctorName: doc.name, when, reason };
    appState.appointments.push(appt); save(); alert('Appointment booked'); showView('dashboard');
  });
}

// History
function renderHistory(){ contentTop.innerHTML = `<div class='card'><h3>Medical History</h3></div>`;
  content.innerHTML = `<div class='card'><label class='field'>Date</label><input id='histDate' type='date'><div class='field mt-8'><label>Notes</label><textarea id='histNotes' rows='3' placeholder='Symptoms, meds, diagnosis'></textarea></div><div style='margin-top:12px;display:flex;gap:8px'><button id='addHist' class='btn'>Add Entry</button><button id='exportJson' class='btn ghost'>Export JSON</button></div></div><div class='card mt-12'><h3>Entries</h3><div id='historyList' class='history-list mt-8'></div></div>`;
  document.getElementById('addHist').addEventListener('click', ()=>{
    const d = document.getElementById('histDate').value || new Date().toISOString().slice(0,10);
    const notes = document.getElementById('histNotes').value.trim();
    if(!notes){ alert('Please add some notes'); return; }
    appState.history.push({id: uid(), date: d, notes}); save(); renderHistory();
  });
  document.getElementById('exportJson').addEventListener('click', ()=>{ const blob = new Blob([JSON.stringify(appState.history, null, 2)], {type:'application/json'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='medical_history.json'; a.click(); });
  renderHistoryList();
}
function renderHistoryList(){ const node = document.getElementById('historyList'); node.innerHTML=''; if(appState.history.length===0) node.innerHTML='<div class="muted">No history entries</div>';
  appState.history.slice().reverse().forEach(h=>{ const el = document.createElement('div'); el.className='history-item'; el.innerHTML = `<div style='font-weight:800'>${h.date}</div><div class='muted' style='margin-top:8px'>${h.notes}</div><div style='margin-top:10px'><button class='btn ghost' data-id='${h.id}'>Delete</button></div>`; node.appendChild(el); });
  node.querySelectorAll('button[data-id]').forEach(b=>b.addEventListener('click', ()=>{ if(!confirm('Delete entry?')) return; appState.history = appState.history.filter(x=>x.id!==b.dataset.id); save(); renderHistory(); }));
}

// Telehealth (local preview)
let localStream = null;
function renderTelehealth(){ contentTop.innerHTML = `<div class='card'><h3>Telehealth Call</h3></div>`;
  content.innerHTML = `<div class='card'><div style='display:flex;gap:12px;flex-direction:column'><label class='field'>Select doctor</label><select id='callDoc'></select><div style='display:flex;gap:8px'><button id='startCallBtn' class='btn'>Start Call</button><button id='endCallBtn' class='btn ghost'>End Call</button></div><div class='video-stage mt-12'><video id='remote' autoplay playsinline muted style='width:65%;height:360px;background:#111;border:1px solid rgba(255,255,255,0.03)'></video><video id='local' autoplay playsinline muted style='width:32%;height:180px;border:1px solid rgba(255,255,255,0.03)'></video></div></div></div>`;
  const sel = document.getElementById('callDoc'); DOCTORS.forEach(d=>{ const opt = document.createElement('option'); opt.value=d.id; opt.textContent = `${d.name} — ${d.specialty}`; sel.appendChild(opt); });
  document.getElementById('startCallBtn').addEventListener('click', async ()=>{
    try{
      const video = document.getElementById('local');
      localStream = await navigator.mediaDevices.getUserMedia({video:{width:640,height:480},audio:true});
      video.srcObject = localStream;
      document.getElementById('remote').srcObject = localStream;
    }catch(err){ alert('Camera access failed: '+err.message); }
  });
  document.getElementById('endCallBtn').addEventListener('click', ()=>{ if(localStream){ localStream.getTracks().forEach(t=>t.stop()); localStream=null; document.getElementById('local').srcObject=null; document.getElementById('remote').srcObject=null; } });
}

// Support: simple advice
function renderSupport(){ contentTop.innerHTML = `<div class='card'><h3>Symptom Support</h3></div>`;
  content.innerHTML = `<div class='card'><label class='field'>Describe your symptoms</label><textarea id='symptoms' rows='3'></textarea><div class='mt-12' style='display:flex;gap:8px'><button id='checkBtn' class='btn'>Get Advice</button><button id='askDoc' class='btn ghost'>Request Doctor</button></div><div id='advice' class='mt-12'></div></div>`;
  document.getElementById('checkBtn').addEventListener('click', ()=>{
    const txt = document.getElementById('symptoms').value.toLowerCase(); if(!txt){ alert('Please describe symptoms'); return; }
    const adv = computeAdvice(txt); document.getElementById('advice').innerHTML = `<div class='advice'><strong>Advice:</strong><div style='margin-top:8px'>${adv}</div></div>`;
  });
  document.getElementById('askDoc').addEventListener('click', ()=>{ alert('A doctor will be notified (simulated). Please book an appointment for a real consult.'); });
}
function computeAdvice(text){ if(/fever|temperature|chills/.test(text) && /cough|sore throat|breath/.test(text)){ return 'You report fever + respiratory symptoms. For mild cases: rest, stay hydrated, monitor temperature. If breathing difficulty, persistent high fever, or chest pain, seek urgent care.'; } if(/headache|migraine/.test(text) && !/fever/.test(text)){ return 'Common headache — rest, hydrate, avoid screens, consider OTC analgesic per usual guidance. If severe or sudden onset, seek emergency care.'; } if(/stomach|nausea|diarrhea/.test(text)){ return 'Gut upset — hydrate with oral rehydration, avoid heavy meals, rest. If severe dehydration, bloody stools, or persistent vomiting, see a clinician.'; } if(/anxiety|sad|depress|sleep/.test(text)){ return 'Low mood or anxiety — try breathing exercises, scheduled routines, and consider reaching out to a mental health professional if symptoms persist. If you have urges of self-harm, call emergency services.'; } return 'For mild symptoms: rest, hydrate, monitor. If symptoms worsen or you are unsure, book an appointment with a clinician.'; }

// Header buttons
document.getElementById('exportHistory').addEventListener('click', ()=>{ const blob = new Blob([JSON.stringify(appState, null, 2)], {type:'application/json'}); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'vhc_full_export.json'; a.click(); });
document.getElementById('helpBtn').addEventListener('click', ()=>{ alert('Local prototype. Book appointments, add medical notes, and start a simulated telehealth call (camera required). All data is stored in your browser only.'); });

// Initial load
load(); renderDoctors(); showView('dashboard');

// expose for debugging
window.vhc = { state: appState, load, save, renderDoctors, renderDashboard };
</script>
</body>
</html>
